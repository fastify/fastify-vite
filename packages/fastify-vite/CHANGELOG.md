# @fastify/vite

## 9.0.0-rc.0

### Major Changes

- 41f488a: Removed "useRelativePaths" option from the viteFastify plugin. This now defaults to `true` - all paths generated by the viteFastify plugin are always relative.
- 54d98d0: Rewrite in TypeScript with ESM-only output.

  ### Breaking Changes

  - **ESM-only package**: The package now sets `"type": "module"` and only ships ESM. CommonJS `require` export entries have been removed.

  - **Node.js compatibility**: Users on Node.js 20.19.0+ or 22.12.0+ can continue using `require('@fastify/vite')` thanks to native [`require(esm)` support](https://joyeecheung.github.io/blog/2025/12/30/require-esm-in-node-js-from-experiment-to-stability/). Users on older Node.js versions must switch to `import` or upgrade Node.js.

  ### Migration

  If you're on an older Node.js version and using CommonJS:

  ```js
  // Before (CJS)
  const fastifyVite = require("@fastify/vite");

  // After (ESM)
  import fastifyVite from "@fastify/vite";
  ```

  Or upgrade to Node.js 20.19.0+ / 22.12.0+ where `require()` of ESM modules is natively supported.

- 937226e: Remove html-rewriter-wasm dependency

  Replaces the stale html-rewriter-wasm dependency (last updated Feb 2022) with regex-based
  string operations. This removes a WebAssembly dependency that was marked as inactive by Snyk.

  **Breaking change:** The undocumented `#varName#` attribute placeholder syntax has been removed.
  This feature only existed in tests and was not documented or used in production code. If you
  were using `<element attr="#varName#">` syntax, switch to the standard comment syntax
  `<!-- varName -->` instead.

  The `createHtmlTemplateFunction` export is now synchronous instead of async. Existing code
  using `await` will continue to work, but you can remove the `await` for a minor performance
  improvement.

- c6b8632: Remove ssrManifest. `@fastify/htmx` will no longer work with this, but it was already broken anyway and I have no permission to publish new version of it. This can be re-visited when work can be resumed here.

### Minor Changes

- 071a8ca: New feature: `baseAssetUrl` to allow serving assets from a CDN

### Patch Changes

- 2b60b32: Fix: Use Vite's resolveConfig to load TypeScript config files without requiring tsx loader

  Previously, `vite.config.ts` files required running Node.js with a TypeScript loader like `tsx` because the config file was directly imported via `import()`. Now the config is loaded through Vite's `resolveConfig` API which handles TypeScript internally using esbuild, and `createServer` is passed the config file path to let Vite handle resolution natively.

- b65fd99: Improve error message when failing to load vite.config.json to remind the app developer about dev mode.
- a2ef9b6: Fix MaxListenersExceededWarning on HMR reconnect. Reuse ServerModuleRunner instances instead of creating new ones on every request.

## 8.4.1

### Patch Changes

- 8abfaf8: Fix static routes to respect registration prefix. When registering @fastify/vite with a `prefix` option, static assets and public files are now correctly served under that prefix.

## 8.4.0

### Minor Changes

- bc8e057: Add TypeScript types to the `viteFastify` plugin and utils exports. #352

### Patch Changes

- 943af16: Check decorators before registering `@fastify/middie` internally. This should allow middie to be registered separately if users want to configure specific options.

## 8.3.1

### Patch Changes

- 31d2759: Fix a bug where using a relative path for `build.outDir` instead of an absolute path in vite configs did not work. #350

## 8.3.0

### Minor Changes

- 6af9432: Enable starting the fastify server from outside the project root

## 8.2.3

### Patch Changes

- 58bc70a: Format all files with oxfmt
